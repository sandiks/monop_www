<% content_for :headcontent do%>

<script src="/Scripts/Game/Game.js" type="text/javascript"></script>
<script src="/Scripts/Game/PlayerCells.js" type="text/javascript"></script>

<script type="text/javascript">
         var cells = [{"id":0,"type":0,"descr":"","title":"Старт","rent":"*","price":0,"hcost":0},{"id":1,"type":1,"descr":"Солнечная Испания","title":"Майорка","rent":"20;100;300;900;1600;2500","price":200,"hcost":500},{"id":2,"type":4,"descr":"вам нужно тянуть карту","title":"Общая казна","rent":"*","price":0,"hcost":0},{"id":3,"type":1,"descr":"","title":"Барселона","rent":"40;200;600;1800;3200;4500","price":600,"hcost":500},{"id":4,"type":6,"descr":"налоговая, заплатите налоги $2000","title":"Налгв","rent":"2000","price":0,"hcost":0},{"id":5,"type":2,"descr":"траснпортная компания, рента для (1) 250, (если две) 500, три 1000, (4) 2000","title":"Дойчебан","rent":"250;500;1000;2000","price":2000,"hcost":0},{"id":6,"type":1,"descr":"","title":"Крит","rent":"60;300;900;2700;4000;5500","price":1000,"hcost":500},{"id":7,"type":4,"descr":"вам нужно тянуть карту","title":"Шанс","rent":"*","price":0,"hcost":0},{"id":8,"type":1,"descr":"","title":"Санторини","rent":"60;300;900;2700;4000;5500","price":1000,"hcost":500},{"id":9,"type":1,"descr":"","title":"Корфу","rent":"80;400;1000;3000;4500;6000","price":1200,"hcost":500},{"id":10,"type":0,"descr":"","title":"Участок","rent":"*","price":0,"hcost":0},{"id":11,"type":1,"descr":"","title":"Венеция","rent":"100;500;1500;4500;6250;7500","price":1400,"hcost":1000},{"id":12,"type":3,"descr":"если у вас только одна компания(без Голландских ветряков), то рента равна 40 * (очки броска), две 100 * бросок","title":"Соларсити глобал плантс","rent":"40","price":1500,"hcost":0},{"id":13,"type":1,"descr":"","title":"Сицилия","rent":"100;500;1500;4500;6250;7500","price":1400,"hcost":1000},{"id":14,"type":1,"descr":"","title":"Милан","rent":"120;600;1800;5000;7000;9000","price":1600,"hcost":1000},{"id":15,"type":2,"descr":"траснпортная компания, рента для (1) 250, (если две) 500, три 1000, (4) 2000","title":"Аэрофлот","rent":"250;500;1000;2000","price":2000,"hcost":0},{"id":16,"type":1,"descr":"","title":"Ньюкасл","rent":"140;700;2000;5500;7500;9500","price":1800,"hcost":1000},{"id":17,"type":4,"descr":"вам нужно тянуть карту","title":"Общая казна","rent":"*","price":0,"hcost":0},{"id":18,"type":1,"descr":"","title":"Манчестер","rent":"140;700;2000;5500;7500;9500","price":1800,"hcost":1000},{"id":19,"type":1,"descr":"","title":"Лондон","rent":"160;800;2200;6000;8000;10000","price":2000,"hcost":1000},{"id":20,"type":0,"descr":"","title":"Рынок","rent":"*","price":0,"hcost":0},{"id":21,"type":1,"descr":"","title":"Питер","rent":"180;900;2500;7000;8750;10500","price":2200,"hcost":1500},{"id":22,"type":4,"descr":"вам нужно тянуть карту","title":"Шанс","rent":"*","price":0,"hcost":0},{"id":23,"type":1,"descr":"","title":"Ярославль","rent":"180;900;2500;7000;8750;10500","price":2200,"hcost":1500},{"id":24,"type":1,"descr":"","title":"Москва","rent":"200;1000;3000;7500;9250;11000","price":2400,"hcost":1500},{"id":25,"type":2,"descr":"траснпортная компания, рента для (1) 250, (если две) 500, три 1000, (4) 2000","title":"Лондон ундэграунд","rent":"250;500;1000;2000","price":2000,"hcost":0},{"id":26,"type":1,"descr":"","title":"Марсель","rent":"220;1100;3300;8000;9750;11500","price":2600,"hcost":1500},{"id":27,"type":1,"descr":"","title":"Канны","rent":"220;1100;3300;8000;9750;11500","price":2600,"hcost":1500},{"id":28,"type":3,"descr":"если у вас только одна компания(без Соларсити глобал плантс), то рента равна 40 * (очки броска), две 100 * бросок","title":"Голландские ветряки","rent":"40","price":1500,"hcost":0},{"id":29,"type":1,"descr":"","title":"Париж","rent":"240;1200;3600;8500;10250;12000","price":2800,"hcost":1500},{"id":30,"type":0,"descr":"","title":"Полиция","rent":"*","price":0,"hcost":0},{"id":31,"type":1,"descr":"","title":"Майами","rent":"260;1300;3900;9000;11000;12750","price":3000,"hcost":2000},{"id":32,"type":1,"descr":"","title":"Сан-франциско","rent":"260;1300;3900;9000;11000;12750","price":3000,"hcost":2000},{"id":33,"type":4,"descr":"вам нужно тянуть карту","title":"Общая казна","rent":"*","price":0,"hcost":0},{"id":34,"type":1,"descr":"","title":"Нью-Йорк","rent":"280;1500;4500;10000;12000;14000","price":3200,"hcost":2000},{"id":35,"type":2,"descr":"траснпортная компания, рента для (1) 250, (если две) 500, три 1000, (4) 2000","title":"Панамаская флотилия","rent":"250;500;1000;2000","price":2000,"hcost":0},{"id":36,"type":4,"descr":"вам нужно тянуть карту","title":"Шанс","rent":"*","price":0,"hcost":0},{"id":37,"type":1,"descr":"","title":"Киото","rent":"350;1750;5000;11000;13000;15000","price":3500,"hcost":2000},{"id":38,"type":6,"descr":"таможня, заплатите $1000","title":"Тмжня","rent":"1000","price":0,"hcost":0},{"id":39,"type":1,"descr":"","title":"Токио","rent":"500;2000;6000;14000;17000;20000","price":4000,"hcost":2000}];
         var plrs = ["kilk","fedor(b)","vitek(b)"];
         var pcolors = ["#FF8080","LightBlue","LightGreen","Yellow","Gray"];
         var pimages = ["<img src='/Content/images/p/p0.png' >","<img src='/Content/images/p/p1.png' >","<img src='/Content/images/p/p2.png' >","<img src='/Content/images/p/p3.png' >"];

         var pl_pos=[0,0,0,0];
         function update_page() {
         	$.get("/game/view_update",
         		function(data) {
         			UpdatePage(data);
         		});
         }
         function step() {
               	item = {id:0, pos:7}
				var images = ['/Content/images/p/p0.png','/Content/images/p/p1.png','/Content/images/p/p2.png','/Content/images/p/p3.png'];

	         	
				last = pl_pos[item.id]

				forward = last < item.pos || (last - item.pos > 25);
				steps = forward ? item.pos - last : last - item.pos;
				steps = steps < 0 ? steps + 40 : steps;

				for (var i = 0; i <= steps; i++) {
					curr = forward ? (last + i) % 40 : last - i;
					//$('#map_c' + curr).animate({ background:'url('+images[item.id]+')'},350);
					//$('#map_c' + curr).css('background-image', 'url('+images[item.id]+')');
					$('#map_c' + curr).append(pimages[item.id]);
                    $('#map_c' + curr+' img').hide();
					
					if (i==steps) {
						$('#map_c' + curr+' img').delay( i*300 ).fadeIn( 200 );
					}
					else{
						$('#map_c' + curr+' img').delay( i*300 ).fadeIn( 200 ).fadeOut(100);
					}

				}
  	
         }

         $(document).ready(function() {

 			$( "button" ).click(function() {
 				step();
			});
         });
				
    </script>

<% end %>

<button>step</button>
<input type="hidden" id="my_pid" value="0" /> 
<table style="width: 100%;">
    <tr>
       
        <td style="vertical-align: top;">
				
            <div style="margin-bottom: 15px;">
                <div id="plinfo"></div>
                
            </div>
            <div id="player_buttons" style="margin-bottom: 5px;"></div>
            
            <%= partial 'shared/map' %>

        </td>
        <td style="vertical-align: top;width: 40%;">
            <div id="log"></div>
        </td>

    </tr>

</table>
